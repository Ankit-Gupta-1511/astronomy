#!/bin/bash
Fail()
{
    echo "ERROR($0): $1"
    exit 1
}

python3 --version || Fail "Cannot print python version"
python3 test.py time || Fail "Failure reported by test.py (time)"
python3 test.py moon || Fail "Failure reported by test.py (moon)"
python3 test.py seasons seasons/seasons.txt || Fail "Failed Python seasons test."

echo "$0: Generating Python test output."
time python3 test.py astro_check > temp/py_check.txt || Fail "Failure in Python astro_check"
./generate check temp/py_check.txt || Fail "Verification failure for Python unit test output."
if false; then
    # For some reason (alt, az) calculations are a tiny bit off (8e-11) in Python.
    ./ctest diff temp/{py,js}_check.txt || Fail "Diff(py,js) failure."
fi
exit 0
